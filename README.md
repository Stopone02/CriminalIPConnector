# OpenCTI용 Criminal IP 커넥터

이 OpenCTI용 커넥터는 [Criminal IP API](https://www.criminalip.io/)의 포괄적인 위협 인텔리전스 데이터를 활용하여 옵저버블(Observable)의 강화(enrichment) 작업을 자동화합니다. 보안 분석가들이 OpenCTI 플랫폼 내에서 IP 주소와 도메인에 대한 컨텍스트를 즉시 파악하여 조사 프로세스를 간소화할 수 있도록 설계되었습니다.

## 주요 특징

- **데이터 자동 보강**: OpenCTI에 추가되는 **IP 주소** 및 **도메인 이름** 옵저버블에 대한 상세 정보를 자동으로 가져옵니다.
- **포괄적인 위험 분석**: 전반적인 위험 점수, 피싱 확률, 알려진 취약점 등 Criminal IP의 광범위한 데이터를 활용하여 잠재적 위협에 대한 전체적인 시각을 제공합니다.
- **STIX 2.1 표준 준수**: **인디케이터(Indicators)**, **취약점(Vulnerabilities)**, **위치(Locations)**, **관계(Relationships)** 등 STIX 2.1 객체를 생성하고 연결하여 OpenCTI의 데이터 모델과 원활하게 통합됩니다.
- **사용자 정의 데이터 매핑**: OpenCTI 내의 표준 STIX 필드와 사용자 정의 속성을 채워 원본 데이터를 보존하고 분석가에게 더 깊은 컨텍스트를 제공합니다.

## 보강되는 정보

이 커넥터는 Criminal IP API에서 다양한 데이터 포인트를 가져와 데이터에 대한 상세한 강화 정보를 제공합니다.

### IP 주소에 대한 정보:

- **IP 평판**: 인바운드 및 아웃바운드 위험 점수를 제공합니다.
- **위치**: 국가, 도시, 지역 정보를 사용하여 **위치(Location)** 객체를 생성하고 IP 주소에 연결합니다.
- **AS 정보**: IP가 속한 자율 시스템(Autonomous System) 번호와 이름을 가져와 AutonomousSystem 객체를 생성하고 ‘belongs-to’ 관계를 맺습니다.
- **취약점**: 발견된 CVE는 **취약점(Vulnerability)** 객체로 자동 임포트되어 해당 IP 주소와 연결됩니다.
- **라벨**: `VPN`, `TOR`, `PROXY`, `HOSTING`과 같은 다양한 태그가 빠른 식별을 위해 라벨로 추가됩니다.

### 도메인 이름에 대한 정보:

- **도메인 위험 점수**: 위험 평가를 위해 포괄적인 `domain_score`와 **`phishing_prob`**(피싱 확률)이 제공됩니다.
- **위협 설명**: Criminal IP의 URL 스캔 결과를 바탕으로 피싱 기록, 의심스러운 파일과 같은 주요 위협을 요약하는 설명(Description)이 생성됩니다.
- **라벨**:  파비콘 도메인의 불일치와 같은 특정 발견 사항이 쉬운 필터링 및 분석을 위해 라벨(Labels)로 추가됩니다.
- **IP 확인**: 관련된 IP 주소를 식별하고 도메인과 해당 IP 주소 객체 간에 ‘**resolves-to’** 관계를 생성합니다.
- **국가 정보**: 도메인과 관련된 서버가 위치한 국가 정보를 가져와 위치(Location) 객체를 생성하고 ‘related-to’ 관계를 맺습니다.

## 작동 방식

OpenCTI에 새로운 IP 주소나 도메인 이름이 생성되면 커넥터가 트리거됩니다. 그런 다음 관련 Criminal IP API 엔드포인트에 요청을 보내 인텔리전스를 수집합니다. 반환된 데이터는 파싱되어 STIX 2.1 객체 번들을 만드는 데 사용되며, 이 번들은 다시 OpenCTI로 전송되어 원래의 데이터를 보강합니다. 이 프로세스는 다양한 데이터 포인트를 단일하고 이해하기 쉬운 인디케이터로 결합하여 잠재적 위협에 대한 상세하고 실행 가능한 뷰를 제공합니다.